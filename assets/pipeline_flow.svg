<?xml version="1.0" encoding="UTF-8"?>
<svg width="600" height="800" viewBox="0 0 600 800" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .box { fill: #2c3e50; stroke: #34495e; stroke-width: 2; rx: 8; }
      .text { fill: white; font-family: Arial, sans-serif; font-size: 14px; text-anchor: middle; font-weight: bold; }
      .subtitle { fill: #bdc3c7; font-family: Arial, sans-serif; font-size: 11px; text-anchor: middle; }
      .arrow { stroke: #34495e; stroke-width: 3; fill: none; marker-end: url(#arrowhead); }
      .optional { fill: #7f8c8d; stroke: #95a5a6; stroke-width: 2; stroke-dasharray: 5,5; rx: 8; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#34495e" />
    </marker>
  </defs>
  
  <!-- Apple Health Export -->
  <rect class="box" x="150" y="20" width="300" height="50"/>
  <text class="text" x="300" y="45">Apple Health export.xml</text>
  
  <!-- Arrow 1 -->
  <line class="arrow" x1="300" y1="70" x2="300" y2="90"/>
  
  <!-- 01_cleaning.py -->
  <rect class="box" x="100" y="100" width="400" height="60"/>
  <text class="text" x="300" y="125">01_cleaning.py</text>
  <text class="subtitle" x="300" y="145">(Data Parsing &amp; Cleaning)</text>
  
  <!-- Arrow 2 -->
  <line class="arrow" x1="300" y1="160" x2="300" y2="180"/>
  
  <!-- Daily HR & Apnea Events -->
  <rect class="box" x="120" y="190" width="360" height="50"/>
  <text class="text" x="300" y="215">Daily HR &amp; Apnea Events (.csv)</text>
  
  <!-- Arrow 3 -->
  <line class="arrow" x1="300" y1="240" x2="300" y2="260"/>
  
  <!-- 02_features.py -->
  <rect class="box" x="100" y="270" width="400" height="60"/>
  <text class="text" x="300" y="295">02_features.py</text>
  <text class="subtitle" x="300" y="315">(Feature Engineering)</text>
  
  <!-- Arrow 4 -->
  <line class="arrow" x1="300" y1="330" x2="300" y2="350"/>
  
  <!-- Feature Dataset -->
  <rect class="box" x="120" y="360" width="360" height="50"/>
  <text class="text" x="300" y="385">Feature Dataset (features.csv/.parquet)</text>
  
  <!-- Arrow 5 -->
  <line class="arrow" x1="300" y1="410" x2="300" y2="430"/>
  
  <!-- 04_models.py (Core) -->
  <rect class="box" x="100" y="440" width="400" height="60"/>
  <text class="text" x="300" y="465">04_models.py</text>
  <text class="subtitle" x="300" y="485">(Dual-Track Model Training &amp; Validation)</text>
  
  <!-- Arrow 6 -->
  <line class="arrow" x1="300" y1="500" x2="300" y2="520"/>
  
  <!-- Trained Models -->
  <rect class="box" x="80" y="530" width="440" height="50"/>
  <text class="text" x="300" y="555">Trained Models &amp; Validation Results (models/ dir)</text>
  
  <!-- Arrow 7 -->
  <line class="arrow" x1="300" y1="580" x2="300" y2="600"/>
  
  <!-- Optional Steps -->
  <rect class="optional" x="50" y="610" width="180" height="80"/>
  <text class="text" x="140" y="635">05_explainability.py</text>
  <text class="subtitle" x="140" y="655">(Optional)</text>
  <text class="subtitle" x="140" y="675">SHAP/LIME Analysis</text>
  
  <rect class="box" x="250" y="610" width="120" height="80"/>
  <text class="text" x="310" y="635">06_predict.py</text>
  <text class="subtitle" x="310" y="655">New Data</text>
  <text class="subtitle" x="310" y="675">Prediction</text>
  
  <rect class="box" x="390" y="610" width="120" height="80"/>
  <text class="text" x="450" y="635">07_visualize.py</text>
  <text class="subtitle" x="450" y="655">Chart &amp;</text>
  <text class="subtitle" x="450" y="675">Visualization</text>
  
  <!-- Convergence arrows -->
  <line class="arrow" x1="140" y1="690" x2="250" y2="720"/>
  <line class="arrow" x1="310" y1="690" x2="300" y2="720"/>
  <line class="arrow" x1="450" y1="690" x2="350" y2="720"/>
  
  <!-- 08_report.py -->
  <rect class="box" x="200" y="720" width="200" height="50"/>
  <text class="text" x="300" y="745">08_report.py</text>
  
  <!-- Arrow 8 -->
  <line class="arrow" x1="300" y1="770" x2="300" y2="790"/>
  
  <!-- Final Output -->
  <rect class="box" x="80" y="800" width="440" height="50"/>
  <text class="text" x="300" y="825">Final Analysis Report &amp; Figures (report/ dir)</text>
  
</svg>